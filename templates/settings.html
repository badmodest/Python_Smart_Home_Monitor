<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='/favicon.ico') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='styles/styles.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.css">
  <script src="https://kit.fontawesome.com/7e84202197.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <title>Smart Home Monitor</title>
</head>
<body>
  <div class="bottom-menu">
    <a href="#" class="menu-item"><i class="fas fa-home fa-2x"></i></a>
    <a href="/overview" class="menu-item"><i class="fas fa-chart-bar fa-2x"></i></a>
    <a href="/charts" class="menu-item"><i class="fas fa-tachometer-alt fa-2x"></i></a>
    <a href="/login" action="/login" class="menu-item"><i class="fas fa-sign-out-alt fa-2x"></i></a>
  </div>

  <div class="side-menu">
    <div class="menu-header">Smart Home</div>
    <a href="/" class="menu-item"><i class="fas fa-home fa-lg"></i>Home</a>
    <a href="/overview" class="menu-item"><i class="fas fa-chart-bar fa-lg"></i>Addit</a>
    <a href="/charts" class="menu-item"><i class="fas fa-tachometer-alt fa-lg"></i>Dash</a>
    {% if not is_guest %}
    <a href="#" class="menu-item menu-item-active"><i class="fas fa-gear fa-lg"></i>Settings</a>
    {% endif %}
    {% if hello_username == 'Guest' %}
      <a href="/login" action="/login" class="menu-item"><i class="fas fa-sign-in-alt fa-lg"></i>Log In</a>
    {% else %}
      <a href="/logout" class="menu-item"><i class="fas fa-sign-out-alt fa-lg"></i>Log Out</a>
    {% endif %}
  </div>
  <div class="content">
    <form action="/settings" method="post">
        <div class="settingsElement">
            <a class="title">MQTT Broker Settings</a>
            <div class="inputBox">
                <input type="text" name="mqtt_broker" placeholder="127.0.0.1" class="input" value="{{ mqtt_broker }}">
                <span class="label">MQTT Broker</span>
            </div>
            <div class="inputBox">
                <input type="text" name="mqtt_port" placeholder="1883" class="input" value="{{ mqtt_port }}">
                <span class="label">MQTT Port</span>
            </div>
            <div>
                <button onclick="switchTheme('dark-theme')">Switch Theme</button>
            </div>    
            <button type="submit" class="save" onclick="this.className='saved'"> </button>
        </div>
    </form>
  </div>
  <script>
    function switchTheme(theme) {
        fetch(`/switch-theme/${theme}`)
          .then(response => response.json())
          .then(data => {
            localStorage.setItem('theme', theme);
          });
      }
      function setSavedTheme() {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
          switchTheme(savedTheme);
        }
      }
      document.addEventListener('DOMContentLoaded', setSavedTheme);
  </script>
</body>
</html>
